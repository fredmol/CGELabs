<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Virus Analysis - CGELabs</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
    <div class="header-section">
        <div class="header-content">
            <div class="header-text">
                <h1>Virus Analysis</h1>
                <p class="subtitle">Analyze viral samples using CGE's pipeline.</p>
            </div>
            <div class="header-icon">
                <i class="fas fa-virus"></i>
            </div>
        </div>
    </div>

    <!-- File Input Section -->
    <div class="input-section">
        <div class="input-group">
            <label for="virusFileInput" class="input-label">FastQ File</label>
            <div class="file-input-wrapper">
                <input type="file" id="virusFileInput" accept=".fastq,.fastq.gz,.fq,.fq.gz">
            </div>
            <p id="fileSizeWarning" class="warning-text"></p>
        </div>

        <div class="input-group">
            <label for="virusExperimentName" class="input-label">Experiment Name</label>
            <input type="text" id="virusExperimentName" placeholder="Enter a unique name for this analysis">
            <p id="nameWarning" class="warning-text"></p>
        </div>
        
        <div class="input-group">
            <label class="input-label">Quality Control</label>
            <div class="checkbox-wrapper">
                <input type="checkbox" id="enableVirusQC" checked>
                <label for="enableVirusQC">Run QC before analysis (recommended)</label>
                <button id="virusQcSettingsToggle" class="toggle-button">Advanced QC Settings</button>
            </div>
            <div id="virusQcSettingsPanel" class="settings-panel" style="display:none;">
                <h4>QC Parameters</h4>
                <div class="parameter-grid">
                    <div class="parameter-item">
                        <label for="virusMinLength">Min Length:</label>
                        <input type="number" id="virusMinLength" placeholder="16">
                    </div>
                    <div class="parameter-item">
                        <label for="virusMaxLength">Max Length:</label>
                        <input type="number" id="virusMaxLength" placeholder="2147483647">
                    </div>
                    <div class="parameter-item">
                        <label for="virusMinPhred">Min Phred:</label>
                        <input type="number" id="virusMinPhred" placeholder="20">
                    </div>
                    <div class="parameter-item">
                        <label for="virusMinInternalPhred">Min Internal Phred:</label>
                        <input type="number" id="virusMinInternalPhred" placeholder="0">
                    </div>
                    <div class="parameter-item">
                        <label for="virusMinAverageQuality">Min Average Quality:</label>
                        <input type="number" id="virusMinAverageQuality" placeholder="10">
                    </div>
                    <div class="parameter-item">
                        <label for="virusTrim5Prime">Trim 5' End:</label>
                        <input type="number" id="virusTrim5Prime" placeholder="0">
                    </div>
                    <div class="parameter-item">
                        <label for="virusTrim3Prime">Trim 3' End:</label>
                        <input type="number" id="virusTrim3Prime" placeholder="0">
                    </div>
                </div>
                <p class="settings-note">Leave empty to use default values. Values shown are the defaults.</p>
            </div>
        </div>
    </div>

    <!-- Control Section -->
    <div class="control-section">
        <div class="button-group">
            <button id="beginVirusAnalysis" class="primary-button">
                Begin Analysis
            </button>
        </div>
    </div>

    <!-- Analysis Output Section -->
    <div class="output-section">
        <div class="output-container">
            <div class="output-header">
                <h3>Analysis Progress</h3>
                <p id="statusMessage" class="status-message">Waiting to start analysis...</p>
            </div>
            
            <!-- Collapsible Console -->
            <div class="console-container">
                <div class="console-header" id="virusConsoleHeader">
                    <div class="console-status" id="virusConsoleStatus">Waiting for analysis...</div>
                    <button class="console-toggle" id="virusConsoleToggle">Show</button>
                </div>
                <div class="console-body" id="virusConsoleBody">
                    <pre id="virusOutput" class="console-output"></pre>
                </div>
            </div>
            
            <div class="control-buttons">
                <button id="cancelAnalysis" class="danger-button" style="display: none;">
                    Cancel Analysis
                </button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingSpinner" class="spinner-container" style="display:none;">
            <div class="spinner"></div>
            <p class="spinner-text">Analysis in progress...</p>
        </div>
    </div>

    <!-- Results Section -->
    <div id="resultButtons" class="results-section" style="display:none;">
        <h3>Analysis Complete</h3>
        <div class="result-buttons">
            <button id="openResults" class="secondary-button">
                <span class="button-icon">üìÅ</span>
                Open Results Folder
            </button>
            <button id="openPdf" class="secondary-button">
                <span class="button-icon">üìÑ</span>
                View PDF Report
            </button>
            <button id="openText" class="secondary-button">
                <span class="button-icon">üìù</span>
                View Text Report
            </button>
            <button id="openQcPdf" class="secondary-button">
                <span class="button-icon">üîç</span>
                View QC Report
            </button>
        </div>
    </div>

    <!-- Info Section -->
    <div class="info-section">
        <div class="info-box">
            <h4>About This Analysis</h4>
            <p>This viral analysis pipeline includes:</p>
            <ul>
                <li>Virus identification and typing</li>
                <li>Variant detection and analysis</li>
            </ul>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>

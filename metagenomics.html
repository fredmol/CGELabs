<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Metagenomics Analysis - CGELabs</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
    <div class="header-section">
        <div class="header-content">
            <div class="header-text">
                <h1>Metagenomics Analysis</h1>
                <p class="subtitle">Analyze metagenomics samples using CGE's pipeline.</p>
            </div>
            <div class="header-icon">
                <i class="fas fa-dna"></i>
            </div>
        </div>
    </div>

    <!-- File Input Section -->
    <div class="input-section">
        <div class="input-group">
            <label for="metagenomicsFileInput" class="input-label">FastQ File</label>
            <div class="file-input-wrapper">
                <input type="file" id="metagenomicsFileInput" accept=".fastq,.fastq.gz,.fq,.fq.gz">
            </div>
            <p id="fileSizeWarning" class="warning-text"></p>
        </div>

        <div class="input-group">
            <label for="metagenomicsExperimentName" class="input-label">Experiment Name</label>
            <input type="text" id="metagenomicsExperimentName" placeholder="Enter a unique name for this analysis">
            <p id="nameWarning" class="warning-text"></p>
        </div>
        
        <div class="input-group">
            <label class="input-label">Quality Control</label>
            <div class="checkbox-wrapper">
                <input type="checkbox" id="enableMetagenomicsQC" checked>
                <label for="enableMetagenomicsQC">Run QC before analysis (recommended)</label>
                <button id="metaQcSettingsToggle" class="toggle-button">Advanced QC Settings</button>
            </div>
            <div id="metaQcSettingsPanel" class="settings-panel" style="display:none;">
                <h4>QC Parameters</h4>
                <div class="parameter-grid">
                    <div class="parameter-item">
                        <label for="metaMinLength">Min Length:</label>
                        <input type="number" id="metaMinLength" placeholder="16">
                    </div>
                    <div class="parameter-item">
                        <label for="metaMaxLength">Max Length:</label>
                        <input type="number" id="metaMaxLength" placeholder="2147483647">
                    </div>
                    <div class="parameter-item">
                        <label for="metaMinPhred">Min Phred:</label>
                        <input type="number" id="metaMinPhred" placeholder="20">
                    </div>
                    <div class="parameter-item">
                        <label for="metaMinInternalPhred">Min Internal Phred:</label>
                        <input type="number" id="metaMinInternalPhred" placeholder="0">
                    </div>
                    <div class="parameter-item">
                        <label for="metaMinAverageQuality">Min Average Quality:</label>
                        <input type="number" id="metaMinAverageQuality" placeholder="10">
                    </div>
                    <div class="parameter-item">
                        <label for="metaTrim5Prime">Trim 5' End:</label>
                        <input type="number" id="metaTrim5Prime" placeholder="0">
                    </div>
                    <div class="parameter-item">
                        <label for="metaTrim3Prime">Trim 3' End:</label>
                        <input type="number" id="metaTrim3Prime" placeholder="0">
                    </div>
                </div>
                <p class="settings-note">Leave empty to use default values. Values shown are the defaults.</p>
            </div>
        </div>
        
    </div>

    <!-- Control Section -->
    <div class="control-section">
        <div class="button-group">
            <button id="beginMetagenomicsAnalysis" class="primary-button">
                Begin Analysis
            </button>
        </div>
    </div>

    <!-- Analysis Output Section -->
    <div class="output-section">
        <div class="output-container">
            <div class="output-header">
                <h3>Analysis Progress</h3>
                <p id="statusMessage" class="status-message">Waiting to start analysis...</p>
            </div>
            <pre id="metagenomicsOutput" class="terminal-output"></pre>
            <div class="control-buttons">
                <button id="cancelAnalysis" class="danger-button" style="display: none;">
                    Cancel Analysis
                </button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingSpinner" class="spinner-container" style="display:none;">
            <div class="spinner"></div>
            <p class="spinner-text">Analysis in progress...</p>
        </div>
    </div>

    <!-- Results Section -->
    <div id="resultButtons" class="results-section" style="display:none;">
        <h3>Analysis Complete</h3>
        <div class="result-buttons">
            <button id="openResults" class="secondary-button">
                <span class="button-icon">üìÅ</span>
                Open Results Folder
            </button>
            <button id="openPdf" class="secondary-button">
                <span class="button-icon">üìÑ</span>
                View PDF Report
            </button>
            <button id="openText" class="secondary-button">
                <span class="button-icon">üìù</span>
                View Text Report
            </button>
        </div>
    </div>

    <!-- Info Section -->
    <div class="info-section">
        <div class="info-box">
            <h4>About This Analysis</h4>
            <p>This metagenomics analysis pipeline includes:</p>
            <ul>
                <li>Species identification and abundance estimation</li>
                <li>Community diversity analysis</li>
                <li>Taxonomic classification</li>
                <li>Antimicrobial resistance gene detection</li>
                <li>Functional annotation</li>
            </ul>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
